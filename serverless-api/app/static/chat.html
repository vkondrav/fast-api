<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>Chat</title>

	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet">
	<link href="/chat-style.css" rel="stylesheet">
	<script src="https://cdn.ably.com/lib/ably.min-1.js"></script>
	<script src="/chat.js"></script>

	<style>
		.chat-img {
			border-radius: 50%;
			overflow: hidden;
			width: 50px;
			height: 50px;
			border: 2px solid #000;
		}

		.chat-img img {
			width: 100%;
			height: 100%;
			object-fit: cover;
		}

		.full-screen {
			height: 100vh;
		}

		.content {
			overflow-y: scroll;
		}

		.input-group {
			padding-bottom: 16px;
		}

	</style>
</head>

<body>

	<template id="message-template-in">
		<li class="in">
			<div class="chat-img">
				<img alt="Avatar">
			</div>
			<div class="chat-body">
				<div class="chat-message">
					<h5></h5>
					<p></p>
				</div>
			</div>
		</li>
	</template>

	<template id="message-template-out">
		<li class="out">
			<div class="chat-img">
				<img alt="Avatar">
			</div>
			<div class="chat-body">
				<div class="chat-message">
					<h5></h5>
					<p></p>
				</div>
			</div>
		</li>
	</template>

	<div class="container-fluid full-screen d-flex flex-column">

		<div class="content flex-grow-1">
			<ul id="messages" class="chat-list"></ul>
		</div>

		<div id="input" class="input-group">
			<input type="text" id="messageInput" class="form-control" placeholder="Type your message here" />
			<div class="input-group-append">
				<button class="btn btn-primary" onclick="sendMessage()">Send</button>
			</div>
		</div>

	</div>

	<script>
		subscribe();
		fetchMessages();
		setInterval(fetchMessages, 30000);
	</script>

</body>